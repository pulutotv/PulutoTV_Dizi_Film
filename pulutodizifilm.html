<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Shaka Oynatıcı</title><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet"><style>:root{--bg-dark:#1a1a2e;--bg-medium:#16213e;--bg-light:#0f3460;--primary-accent:#e94560;--text-light:#e0e0e0;--text-medium:#b0b0b0;--card-bg:#222c42;--border-color:#0f3460;--focus-glow:rgba(233,69,96,.6)}body{font-family:'Poppins',sans-serif;background-color:var(--bg-dark);margin:0;padding:0;color:var(--text-light);display:flex;justify-content:center;align-items:flex-start;min-height:100vh;overflow-x:hidden}.container{max-width:1400px;width:95%;margin:30px auto;background-color:var(--bg-medium);padding:30px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.4);animation:fadeIn .8s ease-out}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}h1,h2{color:var(--primary-accent);text-align:center;margin-bottom:25px;font-weight:600}h2{margin-top:40px;margin-bottom:20px;text-align:left;border-bottom:2px solid var(--border-color);padding-bottom:10px}.search-container{margin-bottom:30px;padding:18px;background-color:var(--bg-light);border-radius:8px;display:flex;align-items:center;gap:15px;box-shadow:inset 0 2px 5px rgba(0,0,0,.2)}#searchInput{flex-grow:1;padding:12px 18px;border:1px solid var(--border-color);border-radius:6px;font-size:1.1em;background-color:var(--card-bg);color:var(--text-light);transition:all .3s ease}#searchInput::placeholder{color:var(--text-medium)}#searchInput:focus{outline:none;border-color:var(--primary-accent);box-shadow:0 0 0 3px var(--focus-glow)}.categories{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:30px;justify-content:center}.category-button{padding:10px 20px;background-color:var(--bg-light);color:var(--text-light);border:none;border-radius:25px;cursor:pointer;font-size:1em;font-weight:400;transition:all .3s ease;box-shadow:0 2px 8px rgba(0,0,0,.2)}.category-button:hover{background-color:var(--primary-accent);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.3)}.category-button.active{background-color:var(--primary-accent);box-shadow:0 0 0 3px var(--focus-glow),0 4px 12px rgba(0,0,0,.3);transform:translateY(-2px)}.content-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:25px;padding-top:10px}.content-item{background-color:var(--card-bg);border-radius:10px;overflow:hidden;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease,outline .2s ease;position:relative;box-shadow:0 5px 15px rgba(0,0,0,.3)}.content-item:hover{transform:translateY(-7px);box-shadow:0 8px 25px rgba(0,0,0,.5)}.content-item.focused{outline:3px solid var(--primary-accent);box-shadow:0 0 0 5px var(--focus-glow),0 8px 25px rgba(0,0,0,.6);transform:translateY(-5px)}.content-item img{width:100%;height:160px;object-fit:cover;display:block;border-bottom:1px solid var(--border-color)}.content-info{padding:15px;min-height:100px;display:flex;flex-direction:column;justify-content:space-between}.content-info h3{margin-top:0;margin-bottom:8px;font-size:1.15em;color:var(--text-light);text-align:left;line-height:1.3}.content-info p{font-size:.85em;color:var(--text-medium);margin-bottom:4px;line-height:1.4;max-height:4.2em;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:3;-webkit-box-orient:vertical}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center;backdrop-filter:blur(8px);opacity:0;visibility:hidden;transition:opacity .3s ease,visibility .3s ease;z-index:1000}.modal.is-visible{opacity:1;visibility:visible;animation:modalFadeIn .3s ease-out}@keyframes modalFadeIn{from{opacity:0}to{opacity:1}}.modal-content{background-color:var(--bg-medium);padding:30px;border-radius:12px;width:90%;max-width:900px;box-shadow:0 15px 40px rgba(0,0,0,.6);position:relative;animation:modalSlideUp .4s ease-out}@keyframes modalSlideUp{from{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}.close-button{color:var(--text-medium);font-size:36px;font-weight:bold;cursor:pointer;position:absolute;top:15px;right:25px;transition:color .3s ease}.close-button:hover,.close-button:focus{color:var(--primary-accent);text-decoration:none}#video-player-container{width:100%;height:0;padding-bottom:56.25%;position:relative;margin-bottom:25px;border-radius:8px;overflow:hidden}.shaka-player-container{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;border-radius:8px;}.shaka-player-video{width:100%;height:100%}.shaka-player-controls{position:absolute;bottom:0;width:100%;background:linear-gradient(to top,rgba(0,0,0,.7) 0%,rgba(0,0,0,0) 100%);padding:10px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;}.shaka-player-controls button{background:none;border:1px solid #fff;color:#fff;padding:8px 15px;margin:0 5px;cursor:pointer;border-radius:5px;}.shaka-player-controls button:hover{background-color:rgba(255,255,255,.2);}.shaka-spinner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border:4px solid rgba(255,255,255,.3);border-top:4px solid var(--primary-accent);border-radius:50%;width:40px;height:40px;animation:spin .8s linear infinite;display:none;z-index:99}.shaka-spinner.active{display:block;}#contentDetails{padding-top:10px}#contentDetails h2{margin-top:0;color:var(--primary-accent);text-align:left;font-size:1.8em;border-bottom:none;padding-bottom:0}#contentDetails p{font-size:1em;line-height:1.6;color:var(--text-light);margin-bottom:10px}#playerErrorMessage{color:var(--primary-accent);background-color:#3b111a;border:1px solid var(--primary-accent);padding:15px;margin-top:15px;border-radius:8px;display:none;text-align:center;font-size:1.1em;word-break:break-word}.direct-test-button{display:block;width:fit-content;margin:15px auto 0 auto;padding:10px 20px;background-color:#4CAF50;color:white;border:none;border-radius:5px;cursor:pointer;font-size:1em;transition:background-color .3s ease}.direct-test-button:hover{background-color:#45a049}.empty-state,.error-message{text-align:center;padding:50px;color:var(--text-medium);font-size:1.2em;background-color:var(--card-bg);border-radius:8px;margin-top:20px;box-shadow:inset 0 2px 5px rgba(0,0,0,.2)}.error-message{color:var(--primary-accent);font-weight:bold;border:1px solid var(--primary-accent)}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.loading-spinner{border:4px solid rgba(255,255,255,.3);border-top:4px solid var(--primary-accent);border-radius:50%;width:40px;height:40px;animation:spin .8s linear infinite;margin:20px auto;display:none}.loading-spinner.active{display:block}</style></head><body><div class="container"><h1>Dizi ve Film Oynatıcı</h1><div class="search-container"><input type="text" id="searchInput" placeholder="İçerik ara..."></div><div id="contentSection"><h2>Kategoriler</h2><div class="categories" id="categoryButtons"></div><h2>İçerikler</h2><div id="contentGrid" class="content-grid"></div><div class="loading-spinner" id="loadingSpinner"></div><div id="emptyState" class="empty-state" style="display:none;"><p>Yüklenecek içerik bulunamadı veya M3U linki geçersiz.</p></div><div id="errorMessage" class="error-message" style="display:none;"></div></div></div><div id="videoModal" class="modal"><div class="modal-content"><span class="close-button">×</span><div id="video-player-container"><div class="shaka-player-container"><video id="videoPlayer" class="shaka-player-video" autoplay controls></video><div class="shaka-spinner" id="shakaSpinner"></div></div></div><div id="playerErrorMessage" style="display: none;"></div><div id="contentDetails"><h2></h2><p></p><button id="directPlayButton" class="direct-test-button" style="display: none;">Video Linkini Doğrudan Aç</button></div></div></div><script src="https://ajax.googleapis.com/ajax/libs/shaka-player/4.8.0/shaka-player.compiled.js"></script><script>document.addEventListener('DOMContentLoaded',()=>{const sI=document.getElementById('searchInput'),cB=document.getElementById('categoryButtons'),cG=document.getElementById('contentGrid'),eS=document.getElementById('emptyState'),eM=document.getElementById('errorMessage'),lS=document.getElementById('loadingSpinner'),vM=document.getElementById('videoModal'),clB=document.querySelector('.close-button'),vPC=document.getElementById('video-player-container'),vP=document.getElementById('videoPlayer'),sPS=document.getElementById('shakaSpinner'),cdT=document.querySelector('#contentDetails h2'),cdD=document.querySelector('#contentDetails p'),pEM=document.getElementById('playerErrorMessage'),dPB=document.getElementById('directPlayButton');let aC=[],cC='Tümü',cST='',fEI=-1,shakaP=null,cVU='';const M3U_LINK='https://raw.githubusercontent.com/pulutotv/PulutoTV_Dizi_Film/refs/heads/main/dizifun.m3u';shaka.log.setLevel(shaka.log.Level.V2);const sME=(e,t,s=!1)=>{e.textContent=t;e.style.display='block';s?e.classList.add('error-message'):e.classList.remove('error-message')};const hME=e=>{e.style.display='none';e.textContent=''};const sL=()=>{lS.classList.add('active');hME(eS);hME(eM)};const hL=()=>{lS.classList.remove('active')};if(M3U_LINK==='YOUR_M3U_LINK_HERE'||(!M3U_LINK.startsWith('http')&&!M3U_LINK.endsWith('.m3u'))){sME(eM,'Hata: Geçerli M3U linki girin.',!0);sME(eS,'M3U linki yapılandırılmamış veya geçersiz.');}else{lM(M3U_LINK);}sI.addEventListener('input',e=>{cST=e.target.value.toLowerCase();fC(cC,cST);});async function lM(e){hME(eM);sL();try{const t=await fetch(e);if(!t.ok){const s=`M3U yüklenirken HTTP hatası: ${t.status}. CORS/erişilebilirlik kontrol edin.`;throw console.error('M3U hata:',t.status,t.statusText),sME(eM,s,!0),new Error(s);}const r=await t.text();if(!r.startsWith('#EXTM3U')){const e='M3U format hatası. #EXTM3U ile başlamıyor.';throw console.error('M3U format hatası: Geçersiz dosya'),sME(eM,e,!0),new Error(e);}pM(r);0===aC.length?sME(eS,'İçerik bulunamadı.'):hME(eS);hL();dC();fC(cC,cST);if(aC.length>0)fFNE();}catch(e){let t=`M3U yüklenirken sorun: ${e.message}.`;if(e.message.includes('Failed to fetch')||e.message.includes('NetworkError'))t+=' Ağ/CORS hatası olabilir.';sME(eM,t,!0);sME(eS,'İçerik yüklenemedi.');hL();}}function pM(e){const t=e.split('\n');aC=[];let s=null;for(const e of t){const t=e.trim();if(t.startsWith('#EXTINF:')){const e=t.match(/#EXTINF:(-?\d+)\s*(.*?),\s*(.*)/);if(e){const t=e[2],o=e[3].trim(),n=t.match(/tvg-logo="([^"]*)"/),a=t.match(/group-title="([^"]*)"/),r=t.match(/genre="([^"]*)"/),c=t.match(/description="([^"]*)"/);let d=a?a[1]:'Diğer';const M=o.toLowerCase(),p=d.toLowerCase(),u=r?r[1].toLowerCase():'';if(p.includes('dizi')||u.includes('dizi')||M.includes('dizi'))d='Dizi';else if(p.includes('film')||u.includes('film')||M.includes('film'))d='Film';else if(p.includes('series'))d='Dizi';else if(p.includes('movie'))d='Film';s={title:o,logo:n?n[1]:'https://via.placeholder.com/220x160?text=Resim+Yok',group:d,genre:r?r[1]:'Bilinmeyen',description:c?c[1]:'Açıklama yok.',url:''}}}else if(t.startsWith('http')&&s){s.url=t;aC.push(s);s=null;}}}function dC(){cB.innerHTML='';const e=new Set(['Tümü','Dizi','Film']);aC.forEach(t=>{if(t.group!=='Dizi'&&t.group!=='Film')e.add(t.group);});e.forEach(e=>{const t=document.createElement('button');t.classList.add('category-button');if(e===cC)t.classList.add('active');t.textContent=e;t.addEventListener('click',()=>{document.querySelectorAll('.category-button').forEach(e=>e.classList.remove('active'));t.classList.add('active');cC=e;sI.value='';cST='';fC(e,cST);fFNE();});cB.appendChild(t);});}function fC(e,t){cG.innerHTML='';let s=aC;if(e!=='Tümü')s=s.filter(t=>t.group===e);if(t)s=s.filter(e=>e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.group.toLowerCase().includes(t)||e.genre.toLowerCase().includes(t));if(0===s.length){cG.innerHTML='<div class="empty-state"><p>İçerik bulunamadı.</p></div>';hME(eS);}else{s.forEach(e=>{const t=document.createElement('div');t.classList.add('content-item');t.tabIndex=0;t.setAttribute('role','button');t.dataset.url=e.url;t.dataset.title=e.title;t.dataset.desc=e.description;t.innerHTML=`<img src="${e.logo}" alt="${e.title}"><div class="content-info"><h3>${e.title}</h3><p>${e.description}</p></div>`;cG.appendChild(t);});fEI=-1;}}function oVM(e){hME(pEM);dPB.style.display='none';cdT.textContent=e.title;cdD.textContent=e.description;cVU=e.url;if(!cVU){sME(pEM,`Hata: "${e.title}" için video linki bulunamadı. M3U dosyanızı kontrol edin.`,!0);return;}if(!shaka.Player.is */* supported()){sME(pEM,'Tarayıcınız Shaka Player tarafından desteklenmiyor. Lütfen güncel bir tarayıcı kullanın.',!0);return;}if(shakaP){shakaP.destroy();shakaP=null;}shakaP=new shaka.Player(vP);shakaP.addEventListener('error',e=>{console.error('Shaka Player Hata:',e.detail);sME(pEM,`Shaka Player hatası: ${e.detail.code} - ${e.detail.message}`,!0);dPB.style.display='block';sPS.classList.remove('active');});shakaP.addEventListener('buffering',e=>{if(e.buffering){sPS.classList.add('active');}else{sPS.classList.remove('active');}});sPS.classList.add('active');const t=localStorage.getItem(`video-progress-${e.url}`);let s=0;if(t&&parseFloat(t)>5&&confirm(`Kaldığınız yerden (${fT(parseFloat(t))}) devam etmek ister misiniz?`)){s=parseFloat(t);}shakaP.load(cVU,s).then(()=>{sPS.classList.remove('active');vP.play().catch(e=>{console.warn('Shaka Player: Otomatik oynatılamadı (tarayıcı kısıtlaması):',e);sME(pEM,'Video otomatik oynatılamadı. Manuel oynatın veya doğrudan açın.',!0);dPB.style.display='block';});}).catch(e=>{console.error('Shaka Player Yükleme Hatası:',e);let t=`Video yüklenirken Shaka Player hatası: ${e.code} - ${e.message}`;if(e.code===6001||e.code===6002||e.code===6003)t='Video formatı desteklenmiyor veya ağ hatası var.';sME(pEM,t,!0);dPB.style.display='block';sPS.classList.remove('active');});vP.addEventListener('timeupdate',()=>{localStorage.setItem(`video-progress-${cVU}`,vP.currentTime);});vM.classList.add('is-visible');}dPB.addEventListener('click',()=>{if(cVU)window.open(cVU,'_blank');});const fT=e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),o=Math.floor(e%60);return`${0<t?`${t}:`:''}${s<10?`0${s}`:s}:${o<10?`0${o}`:o}`};const cM=()=>{if(shakaP){const e=vP.currentSrc;if(e)localStorage.setItem(`video-progress-${e}`,vP.currentTime);shakaP.destroy();shakaP=null;vP.removeAttribute('src');vP.load();}hME(pEM);dPB.style.display='none';vM.classList.remove('is-visible');const e=document.querySelector('.content-item.focused')||document.querySelector('.category-button.active');if(e)e.focus();else fFNE();};clB.addEventListener('click',cM);vM.addEventListener('click',e=>{if(e.target===vM)cM();});cG.addEventListener('click',e=>{const t=e.target.closest('.content-item');if(t){const s={url:t.dataset.url,title:t.dataset.title,description:t.dataset.desc};oVM(s);}});cG.addEventListener('keydown',e=>{if(e.key==='Enter'||e.key===' '){const t=e.target.closest('.content-item');if(t){e.preventDefault();const s={url:t.dataset.url,title:t.dataset.title,description:t.dataset.desc};oVM(s);}}});const gNE=()=>{const e=[];if(sI.offsetParent!==null&&window.getComputedStyle(sI).display!=='none')e.push(sI);cB.querySelectorAll('.category-button').forEach(t=>{if(t.offsetParent!==null&&window.getComputedStyle(t).display!=='none')e.push(t);});cG.querySelectorAll('.content-item').forEach(t=>{if(t.offsetParent!==null&&window.getComputedStyle(t).display!=='none')e.push(t);});return e;};const rFA=()=>{document.querySelectorAll('.focused').forEach(e=>e.classList.remove('focused'));document.querySelectorAll('.category-button.active:not([data-active-permanent="true"])').forEach(e=>{e.classList.remove('active');});};const fE=e=>{const t=gNE();if(e>=0&&e<t.length){rFA();t[e].classList.add('focused');t[e].focus();fEI=e;if(t[e].classList.contains('category-button'))t[e].classList.add('active');}};const fFNE=()=>fE(0);document.addEventListener('keydown',e=>{const t=gNE();if(0===t.length)return;if(vM.classList.contains('is-visible')){if(e.key==='Escape'||e.key==='Backspace'||e.key==='MediaStop'){e.preventDefault();cM();return;}return;}let s=fEI;const o=t[fEI];if(e.key==='ArrowRight'){s++;}else if(e.key==='ArrowLeft'){s--;}else if(e.key==='ArrowDown'){if(o===sI){s=t.indexOf(cB.querySelector('.category-button.active'))||t.indexOf(cB.children[0])||t.indexOf(cG.querySelector('.content-item'))||(fEI+1);}else if(o&&o.classList.contains('category-button')){s=t.indexOf(cG.querySelector('.content-item'))||(fEI+1);}else if(o&&o.classList.contains('content-item')){s+=Math.max(1,Math.floor(cG.offsetWidth/o.offsetWidth));}else{s++;}}else if(e.key==='ArrowUp'){if(o&&o.classList.contains('content-item')){s-=Math.max(1,Math.floor(cG.offsetWidth/o.offsetWidth));if(s<t.indexOf(cB.querySelector('.category-button'))||s<t.indexOf(sI)){s=t.indexOf(cB.querySelector('.category-button.active'))||t.indexOf(cB.children[0])||t.indexOf(sI);}}else if(o&&o.classList.contains('category-button')){s=t.indexOf(sI);}else{s--;}}else if(e.key==='Enter'||e.key===' '){e.preventDefault();if(fEI!==-1){t[fEI].click();if(t[fEI]===sI)sI.focus();}}else if(e.key==='Home'){e.preventDefault();fE(0);}else if(e.key==='End'){e.preventDefault();fE(t.length-1);}s=Math.max(0,Math.min(s,t.length-1));if(s!==fEI){fE(s);t[s].scrollIntoView({behavior:'smooth',block:'nearest'});}});sI.addEventListener('focus',function(){rFA();sI.classList.add('focused');fEI=gNE().indexOf(sI);});sI.addEventListener('blur',function(){sI.classList.remove('focused');});});</script></body></html>
